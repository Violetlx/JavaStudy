### 6 方法引用

​    我们在使用Lambda表达式的时候，如果方法体中只有一个方法的调用的话（包括构造方法），我们可以用方法引用进一步简化代码。



#### 6.1 推荐用法

​    我们在使用Lambda时不需要考虑什么时候用方法引用，用哪种方法引用，方法引用的格式是什么。我们只需要在写完Lambda方法发现方法体中只有一行代码，并且是方法的调用时使用快捷键尝试是否能够转换成方法引用即可。

   当我们方法引用使用的多了慢慢的也可以直接写出方法引用。



#### 6.2 基本格式

#####     类命或者对象名::方法名

```java
/**
 * 1、方法引用
 */
@Test
void methodReference() {
    List<Author> authors = getAuthors();
    authors.stream()
            .distinct()
            .map(Author::getAge)
            .forEach(System.out::println);
}
```



#### 6.3 语法详解（了解）

##### 6.3.1 引用静态资源

​    其实就是引用类的静态方法

##### 格式

```java
类名::方法
```



##### 使用前提

​    如果我们在重写方法的时候，方法中**只有一行代码**，并且这行代码是调用了**某个类的静态方法**，并且我们把要重写的**抽象方法中所有的参数按照顺序传入了这个静态方法中**，这个时候我们就可以引用这个类的静态方法了。



例如：

如下代码可以进行方法引用简化

```java
/**
 * 2、方法引用
 */
@Test
void methodReference2() {
    List<Author> authors = getAuthors();

    /**
     * 如果我们在重写方法的时候，方法中**只有一行代码**，
     * 并且这行代码是调用了**某个类的静态方法**，并且
     * 我们把要重写的**抽象方法中所有的参数按照顺序传入
     * 了这个静态方法中**，这个时候我们就可以引用这个类的静态方法了
     */
    authors.stream()
            .distinct()
            .map(new Function<Author, Integer>() {
                @Override
                public Integer apply(Author author) {//方法体中只有一行代码
                    return author.getAge();
                }
            }).map(new Function<Integer, String>() {
                @Override
                public String apply(Integer age) {
                    return String.valueOf(age);
                }
            }).forEach(new Consumer<String>() {
                @Override
                public void accept(String age) {
                    System.out.println(age);
                }
            });

    System.out.println("-----------------------");

    //Lambda表示式优化
    Stream<Author> authorStream = authors.stream();
    authorStream.distinct()
            .map(author -> author.getAge())
            .map(age->String.valueOf(age))
            .forEach(age -> System.out.println(age));

    System.out.println("-----------------------");

    //方法引用优化
    authors.stream()
            .distinct()
            .map(Author::getAge)
            .map(String::valueOf)
            .forEach(System.out::println);
}
```



##### 6.3.4 引用类的实例方法

##### 格式

```java
对象名::方法名
```

​     如果我们在重写方法的时候，方法体中**只有一行代码**，并且这行代码是调用了**某个对象的成员方法**，并且我们把重写的**抽象方法中所有的参数都按照顺序传入了这个成员方法中**，这个时候我们就可以引用对象的实例方法。

例如：

```java
/**
 * 3、方法引用
 */
@Test
void methodReference3() {
    List<Author> authors = getAuthors();

    Stream<Author> authorStream = authors.stream();
    StringBuffer stringBuffer=new StringBuffer();
    authorStream.distinct()
            .map(author -> author.getName())
            .forEach(name -> stringBuffer.append(name).append(','));

    System.out.println(stringBuffer);

    System.out.println("-----------------------");

    StringBuffer stringBuffer1 = new StringBuffer();

    Stream<Author> stream = authors.stream();
    stream.distinct()
            .map(Author::getName)
           .forEach(stringBuffer1::append);
    System.out.println(stringBuffer1);
}
```



##### 6.3.4 引用类的实例方法

##### 格式

```java
类命::方法名
```



##### 使用前提

​     如果我们在重写方法的时候，方法体中**只有一行代码**，并且这行代码是**调用了第一个参数的成员方法**，并且我们把要**重写的抽象方法中剩余的参数都按照顺序传入这个成员方法中**，这个时候我们就可以引用类的实例方法。



例如：

```java
/**
 * 4、方法引用
 */
interface UseString{
    String use(String str,int start,int length);
}

public static String subAuthorName(String str,UseString useString){
    int start = 0;
    int length = 1;
    return useString.use(str,start,length);
}

@Test
void methodReference4() {
    /**
     * 如果我们在重写方法的时候，方法体中**只有一行代码**，
     * 并且这行代码是**调用了第一个参数的成员方法**，并且
     * 我们把要**重写的抽象方法中剩余的参数都按照顺序传入
     * 这个成员方法中**，这个时候我们就可以引用类的实例方法。
     */
    String s = subAuthorName("LX", new UseString() {
        @Override
        public String use(String str, int start, int length) {
            return str.substring(start, length);
        }
    });
    System.out.println(s);

    System.out.println("-----------------------");

    //优化
    String s1 = subAuthorName("LX", String::substring);

    System.out.println(s1);
}
```



##### 6.3.5 构造器引用

   如果方法体中的一行代码是构造器的话就可以使用构造器引用。



##### 格式

```java
类命::new
```



##### 使用前提

​     如果我们在重写方法的时候，方法体中**只有一行代码**，并且这行代码是**调用了某个类的构造方法**，并且我们要把**重写的抽象方法中的所有的参数都按照顺序传入了这个构造方法中**，这个时候我们就可以引用构造器了。

例如：

```java
/**
 * 5、方法引用
 */
@Test
void methodReference5() {
    List<Author> authors = getAuthors();
    authors.stream()
            .map(author -> author.getName())
            .map(name->new StringBuffer(name))
            .map(sb->sb.append("LX").toString())
            .forEach(str-> System.out.println(str));

    System.out.println("-----------------------");

    //构造器方法引用优化
    authors.stream()
            .map(Author::getName)
            .map(StringBuffer::new)
            .map(sb->sb.append("LX").toString())
            .forEach(System.out::println);
}
```









